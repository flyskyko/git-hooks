#!/bin/bash

file="$HOME/.gitauthor"
export NEW_NAME=$(head -1 $file)
export NEW_EMAIL=$(head -2 $file | tail -1)

count=0
prev=""

while read oldsha newsha
do
	if [ "$prev" != "$newsha" ]; then
		count=$((count+1))
	fi
	prev="$newsha"
done

git filter-branch -f --env-filter '
	export GIT_COMMITTER_NAME="$NEW_NAME"
	export GIT_COMMITTER_EMAIL="$NEW_EMAIL"
' "HEAD~$count..HEAD"
